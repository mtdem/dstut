---
title: "DSCI351-351m-451: Class 01a, (CWRU, Pitt, UCF, UTRGV)"
subtitle: "Profs: R. H. French, L. S. Bruckman, P. Leu, K. Davis, S. Cirlos"
author: "TAs: W. Oltjen, K. Hernandez, M. Li, M. Li, D. Colvin" 
date: "`r format(Sys.time(), '%d %B, %Y')`"
output: 
  pdf_document:
    latex_engine: xelatex
    toc: TRUE
    number_sections: TRUE
    toc_depth: 6
    highlight: tango
  html_notebook:
  html_document:
    css: ../lab.css
    highlight: pygments
    theme: cerulean
    toc: yes
    toc_depth: 6
    toc_float: yes
    df_print: paged
urlcolor: blue
always_allow_html: true
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  cache = FALSE, # if TRUE knitr will cache results to reuse in future knits
  fig.width = 6, # the width for plots created by code chunk
  fig.height = 4, # the height for plots created by code chunk
  fig.align = 'center', # how to align graphics. 'left', 'right', 'center'
  dpi = 300, 
  dev = 'png', # Makes each fig a png, and avoids plotting every data point
  # eval = FALSE, # if FALSE, then the R code chunks are not evaluated
  # results = 'asis', # knitr passes through results without reformatting
  echo = TRUE, # if FALSE knitr won't display code in chunk above it's results
  message = TRUE, # if FALSE knitr won't display messages generated by code
  strip.white = TRUE, # if FALSE knitr won't remove white spaces at beg or end of code chunk
  warning = TRUE, # if FALSE knitr won't display warning messages in the doc
  error = TRUE) # report errors
  # options(tinytex.verbose = TRUE)
```

 \setcounter{section}{10}
 \setcounter{subsection}{1}
 \setcounter{subsubsection}{3}

# Background

Photovoltaic (PV) modules consist of solar cells, polymers and glass 

  - When exposed in outdoor conditions 
    - (in the presence of humidity, UV irradiation and temperature)
  - PV modules experience degradation
    - In turn, the polymers also degrade
  - Hence, it is important to understand 
    - the packaging strategies and their role in degradation

Packaging strategies involve various components

  - Solar cell type
  - Polymeric materials
    - Encapsulants: 
      - Protect solar cells from external conditions and mechanical impacts
      - Provide electrical isolation as well as structural support [1]
    - Backsheets: provide stability against UV irradiation and moisture
      - Have good reflectance and low water vapor permeability [2,3]
  - Module architecture: rear layer of the PV module
    - Is it glass (double glass or DG) versus polymer (glass/backsheet or GB)?
    
Ethylene vinyl acetate has been around as the polymeric encapsulant for several decades

  - It is a cheaper option and 
    - numerous long-term studies have been performed to understand its behavior
  - It is not really the best because it undergoes chemical degradation
    - In the presence of high temperature and UV irradiation
  - There are emerging materials 
    - like polyolefin elastomer (POE) and thermoplastic polyolefin (TPO)
    - But how well do they actually perform?
    
Degradation takes several decades to manifest

  - Laboratory-based accelerated exposures 
    - try and mimic outdoor degradation of PV modules
  - And it takes only a few days to months 
    - for exposure to complete in accelerated conditions
  
In this study, 4-cell PV modules (referred to as minimodules) 

  - were fabricated at the SDLE Research Center 
  - Using EVA and POE as the encapsulants
  - DG and GB module architectures
    - Double Glass (DG)
    - Glass / Backsheet (GB)
  - Two types of exposure
    - mDH (80$^\circ$C and 85% relative humidity)
    - mDH + FSL: combination of mDH with 420 $Wm^{-2}$ light
  - 2520 hours of exposure
    - Adding up to 5 exposure time steps
    - Baseline (step 0) measurements are also included
  - Now, we want to compare across encapsulants and architectures 
    - (PV minimodule variants) across exposures
    - Using 83.4% and 95% confidence intervals (CIs)
    - And inference by eye

Note that each variant has 2 minimodules, 

  - corresponding to 8 cell-level measurements
  - Improves statistical significance of results
  - Reduces the standard error by $\sqrt{8}$
    
# Confidence intervals and inference by eye

For null hypothesis testing at a 5% significance level

  - We make use of various statistical measures like t-tests, p-values and CIs

95% CIs are the most popular ones

  - Correspond to 5% significance level
  - 95% capture rate used for 1 sample t-test
    - i.e. the estimated mean is in the 95% CI range, 95% of the times
  - Used to identify PV module variants that are durable/degrading
  
In the case of 2 sample t-test, 83.4% CIs are used

  - Enables rank-ordering of variants that are significantly different from each other

Inference by eye was first described by Cumming et al. [4]

  - If we have two independent groups
    - When ends of 95% CIs touch each other, the p-value corresponds to ~0.01
    - When ends of 83.4% CIs touch each other, the p-value is ~0.05
  
Using these ideas, 

  - we can compare between PV minimodule variants

# About the dataset

This dataset consists of 14 variables

  - ID: minimodule name followed by cell number 
    - Cell number can go from 1-4
  - mobr: manufacturer (CWRU)
  - ecp: encapsulant (EVA/POE)
  - arch: minimodule architecture (GB/DG)
  - expt: exposure type (mDH/mDH+FSL)
  - dy: time in decimal year
    - Usually, we have years as whole numbers
    - Decimal year means that there are decimal numbers (like 0.38765)
  - es: exposure step (end of exposure corresponds to step 5)
  - n_Pmp_IV: normalized power from current-voltage measurements
  - ci_n_Pmp variables
    - 83.4% versus 95%
    - 'up' means upper confidence limit
    - 'mean' means mean of the measurements
    - 'low' means lower confidence limit

# Code to plot confidence intervals

The following code chunk pertains to 

  - power output data from current-voltage curves 
  - for 4-cell minimodules fabricated at CWRU.  

```{r}
# load relevant packages
library(magrittr)
library(tidyverse)
library(ggplot2)
library(dplyr)
library(latex2exp)
```

```{r}
# load the data frame
ind_mod <- read.csv("./data/cwru_df.csv", stringsAsFactors = F)

# defining plot theme
# feel free to customize it as per your preferences
plot_theme <-
  theme(
    panel.background = element_rect(fill = "white", colour = "black"),
    panel.grid.major = element_line(colour = "gray", linetype = "dashed"),
    axis.text = element_text(size = 12, face = "bold"),
    axis.text.x = element_text(size = 10,
                               face = "bold",
                               hjust = 1),
    axis.text.y = element_text(size = 10,
                               face = "bold",
                               hjust = 1),
    axis.title = element_text(size = 18),
    strip.text = element_text(size = 12, face = "bold"),
    text = element_text(size = 18),
    panel.spacing = unit(1, "lines"),
    legend.position = "top"
  )
```

```{r}
# CI plot with facet grid
# both 83.4% and 95% CIs are included
# now we can compare across different encapsulants and architectures
# at the end of exposure cycle
# feel free to choose color palettes of your choice; a good source is coolors.co
ind_mod %>%
  ggplot() +
  facet_grid(~ `arch` + `expt`) +
  geom_errorbar(
    aes(
      ymax = ci_n_Pmp_IV_up_95,
      ymin = ci_n_Pmp_IV_low_95,
      y = n_Pmp_IV,
      x = reorder(ecp, n_Pmp_IV),
      color = "#E69F00"
    )
  )  +
  geom_errorbar(
    aes(
      ymax = ci_n_Pmp_IV_up_83.4,
      ymin = ci_n_Pmp_IV_low_83.4,
      y = n_Pmp_IV,
      x = reorder(ecp, n_Pmp_IV),
      color = "#56B4E9"
    )
  ) +
  geom_point(
    aes(y = ci_n_Pmp_IV_mean_95, x = ecp),
    shape = 1,
    size = 2,
    color = "black"
  ) +
  coord_cartesian(y = c(0.8, 1.1)) + # n_Pmp_IV
  labs(y = TeX('$^{n}P_{mp, IV}$ at es = 5'),
       x = 'Encapsulant',
       color = "Confidence interval (in %)") +
  scale_color_manual(labels = c("83.4", "95"),
                     values = c("#56B4E9","#E69F00")) + 
  plot_theme
```

# Interpretation

## 83.4% CIs

It can be seen that there is no significant impact of encapsulant type

  - i.e. 83.4% CIs overlap in each of the architecture/exposure type categories
  
Between categories, 

  - EVA-based minimodules (GB in mDH and mDH+FSL exposures) 
    - are significantly different   
  - From DG in mDH+FSL exposure

In the case of other minimodule categories, 

  - they seem to be similar to each other
  - Due to overlapping 83.4% CIs
      
## 95% CIs      

GB minimodules are seen to be experiencing power loss

  - Estimated means for the GB minimodules: 
    - indicate that the power loss is about 5-6% on average

DG minimodules in mDH exposure 

  - seem to be exhibiting different trends with encapsulant type
  - The ones with EVA have more power loss than the POE type

CIs for DG minimodules in mDH exposure have relatively wider CIs

  - Affecting our understanding of the effect

# References

1. Michele Cândida Carvalho de Oliveira, Antônia Sonia Alves Diniz Cardoso, Marcelo Machado Viana, and Vanessa de Freitas Cunha Lins. The causes and effects of degradation of encapsulant ethylene vinyl acetate copolymer (EVA) in crystalline silicon photovoltaic modules: A review. Renewable and Sustainable Energy Reviews, 81:2299–2317, January 2018. ISSN 1364-0321. doi:10.1016/j.rser.2017.06.039.
https://dx.doi.org/10.1016/j.rser.2017.06.039 

2. Jorma Peltola. New Era in Backsheet Materials? EQ Magazine, September 2016. URL https://www.eqmagpro.com/wp-content/uploads/2016/12/PV-New-Era-in-Backsheet-Materials.pdf.

3. P.Hülsmann and G.M.Wallner. Permeation of water vapour through polyethylene terephthalate (PET) films for back-sheets of photovoltaic modules. Polymer Testing, 58:153–158, April 2017. ISSN 0142-9418. doi:10.1016/j.polymertesting.2016.11.028.
https://dx.doi.org/10.1016/j.polymertesting.2016.11.028

4. Geoff Cumming and Sue Finch. Inference by Eye: Confidence Intervals and How to Read Pictures of Data. American Psychologist, 60(2):170–180, 2005. ISSN 1935-990X(Electronic),0003-066X(Print). doi:10.1037/0003-066X.60.2.170.
https://dx.doi.org/10.1037/0003-066X.60.2.170
 
